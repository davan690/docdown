<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>DocDown</title>
    <link rel="stylesheet" href="./vendor/css/photon.css" media="screen" charset="utf-8">
    <link rel="stylesheet" href="./index.css" media="screen" charset="utf-8">
    <script>window.$ = window.jQuery = require('jquery');</script>
  </head>
  <body>
    <!-- <div class="header-arrow"></div> -->
    <div class="window">
      <header class="toolbar toolbar-header">
        <div class="title">
          DocDown
        </div>

        <div class="toolbar-actions pull-right">
          <div class="btn-group">
            <button id="help_button" class="btn btn-default">
              <span class="icon icon-help" title="Help"></span>
            </button>
            <button id="settings_button" class="btn btn-default">
              <span class="icon icon-cog" title="Preferences"></span>
            </button>
            <button id="quit_button" class="btn btn-default">
              <span class="icon icon-cancel" title="Quit"></span>
            </button>
          </div>
        </div>
      </header>

      <div class="window-content" style="padding:10px;">

          <div id="drag-file">
            <p>
              ‚ö°Ô∏èüìñ‚ö°Ô∏è
            </p>
            <!-- <span class="icon icon-docs" style="font-size: 2em;"></span> -->
            <p>Drag some Markdown files here!</p>
          </div>
          <div id="help_section">
            <p>
              DocDown is a menu bar utility to convert files written in the lightweight Markdown syntax into academia-ready Word documents. Drop a file with the .txt, .md, or .markdown extension into DocDown, or export a file into it from an application like Ulysses, and it will export a Word file into your chosen directory.
            </p>
            <p>
              DocDown requires the file conversion utility Pandoc to be installed on your system to function. You also need to select a Zotero bibliography file, a CSL file, and a reference .docx file in the preferences window. Confused? Visit the <a id="external_link" style="color:inherit" href="https://github.com/lowercasename/docdown">DocDown website</a> to get set up.
            </p>
            <p>
              Happy converting!
            </p>
          </div>

      </div>
    </div>
  </body>
  <script>
  const { ipcRenderer, shell } = require('electron');

  $("#quit_button").click(function(){
    ipcRenderer.send('quit-app');
  })
  $("#settings_button").click(function(){
    ipcRenderer.send('show-preferences');
  });
  $("#help_button").click(function(){
    $("#drag-file").toggle();
    $("#help_section").toggle();
    $(this).toggleClass("active");
  });
  $("#external_link").click(function(e){
    e.preventDefault();
    shell.openExternal('https://github.com/lowercasename/docdown')
  })
  ipcRenderer.on('notify', (event, payload) => {
    let notification = new Notification(payload.title, {
      body: payload.body
    })
  })
  $(document).ready(function() {
      var holder = document.getElementById('drag-file')

      holder.ondragover = () => {
        $("#drag-file").css("background-color","#ededed")
        return false;
      };

      holder.ondragleave = () => {
        $("#drag-file").css("background-color","#fafafa")
          return false;
      };

      holder.ondragend = () => {
        $("#drag-file").css("background-color","#fafafa")
        return false;
      };

      holder.ondrop = (e) => {
          e.preventDefault();
          console.log("Done did dropped!")
          for (let f of e.dataTransfer.files) {
            ipcRenderer.send('convert-file', {"path": f.path, "type": f.type});
          }

          return false;
      };
  });
  </script>
</html>
